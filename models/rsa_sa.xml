<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE nta PUBLIC '-//Uppaal Team//DTD Flat System 1.5//EN' 'http://www.it.uu.se/research/group/darts/uppaal/flat-1_5.dtd'>
<nta>
	<declaration>// Place global declarations here.


const int WORST_CASE = 0;
const int NO_DELAY = 2;
const int RANDOM_DELAY = 4;

const int version = @ENABLE_RANDOM@;



const int SSize = 8;  

typedef struct {
    int s;
    int i;
    int r;
    int x;
    bool key[SSize];
    bool done;
}GState;</declaration>
	<template>
		<name>RSA_delay</name>
		<parameter>GState&amp; s</parameter>
		<declaration>
clock x;
clock glob;
int inter;
bool d=false;
const int upper  = 2;
const int lower = 2;


bool iter_done[SSize];
</declaration>
		<location id="id0" x="-1683" y="-918">
			<label kind="exponentialrate" x="-1717" y="-901">1 : 3*((upper+lower)/2)</label>
		</location>
		<location id="id1" x="-1206" y="-842">
			<name x="-1216" y="-876">G</name>
			<label kind="invariant" x="-1181" y="-858">x&lt;=upper</label>
		</location>
		<location id="id2" x="-1206" y="-1003">
			<name x="-1216" y="-1037">E</name>
			<label kind="invariant" x="-1216" y="-986">x&lt;=upper</label>
		</location>
		<location id="id3" x="-1894" y="-1003">
			<label kind="invariant" x="-1877" y="-986">x&lt;=upper</label>
		</location>
		<location id="id4" x="-1207" y="-1283">
			<name x="-1217" y="-1317">C</name>
			<label kind="invariant" x="-1190" y="-1283">x&lt;=upper</label>
		</location>
		<location id="id5" x="-1318" y="-1283">
			<name x="-1328" y="-1317">B</name>
			<label kind="invariant" x="-1386" y="-1266">x&lt;=upper</label>
		</location>
		<location id="id6" x="-1402" y="-1385">
			<name x="-1412" y="-1419">Done</name>
			<label kind="invariant" x="-1716" y="-1351">glob'==0</label>
			<label kind="exponentialrate" x="-1412" y="-1351">1</label>
		</location>
		<location id="id7" x="-1895" y="-1283">
			<name x="-1905" y="-1317">A</name>
			<label kind="invariant" x="-1886" y="-1266">x&lt;=upper</label>
		</location>
		<location id="id8" x="-2065" y="-1283">
			<label kind="invariant" x="-2124" y="-1266">x&lt;=upper</label>
		</location>
		<location id="id9" x="-1683" y="-603">
			<label kind="invariant" x="-1692" y="-586">x&lt;=upper</label>
		</location>
		<location id="id10" x="-1317" y="-1003">
			<name x="-1327" y="-1037">D</name>
			<label kind="invariant" x="-1402" y="-1011">x&lt;=upper</label>
		</location>
		<location id="id11" x="-1317" y="-841">
			<name x="-1327" y="-875">H</name>
			<committed/>
		</location>
		<location id="id12" x="-1894" y="-841">
			<name x="-1904" y="-875">J</name>
			<label kind="invariant" x="-1996" y="-833">x&lt;=upper</label>
		</location>
		<location id="id13" x="-1683" y="-841">
			<label kind="invariant" x="-1725" y="-824">x&lt;=3*upper</label>
		</location>
		<init ref="id8"/>
		<transition id="id14">
			<source ref="id0"/>
			<target ref="id12"/>
			<label kind="assignment" x="-1818" y="-918">x=0</label>
			<nail x="-1836" y="-918"/>
		</transition>
		<transition id="id15">
			<source ref="id11"/>
			<target ref="id0"/>
			<label kind="guard" x="-1665" y="-952">version == RANDOM_DELAY</label>
			<label kind="assignment" x="-1632" y="-918">x=0</label>
			<nail x="-1351" y="-918"/>
		</transition>
		<transition id="id16">
			<source ref="id13"/>
			<target ref="id12"/>
			<label kind="guard" x="-1836" y="-833">x&gt;=3*lower</label>
			<label kind="assignment" x="-1876" y="-824">x=0</label>
		</transition>
		<transition id="id17">
			<source ref="id11"/>
			<target ref="id13"/>
			<label kind="guard" x="-1538" y="-866">version == WORST_CASE</label>
			<label kind="assignment" x="-1632" y="-832">x = 0</label>
			<nail x="-1343" y="-841"/>
		</transition>
		<transition id="id18">
			<source ref="id11"/>
			<target ref="id12"/>
			<label kind="guard" x="-1530" y="-781">version == NO_DELAY</label>
			<label kind="assignment" x="-1859" y="-621">x=0</label>
			<nail x="-1317" y="-756"/>
			<nail x="-1895" y="-756"/>
		</transition>
		<transition id="id19">
			<source ref="id9"/>
			<target ref="id12"/>
			<label kind="guard" x="-1970" y="-638">x&gt;=lower</label>
			<label kind="assignment" x="-1945" y="-612">x=0</label>
			<nail x="-1895" y="-603"/>
		</transition>
		<transition id="id20">
			<source ref="id12"/>
			<target ref="id3"/>
			<label kind="guard" x="-1894" y="-956">x&gt;=lower</label>
			<label kind="assignment" x="-2013" y="-944">s.s = s.r*s.r,x = 0</label>
		</transition>
		<transition id="id21">
			<source ref="id10"/>
			<target ref="id11"/>
			<label kind="guard" x="-1411" y="-986">x&gt;=lower</label>
			<label kind="assignment" x="-1461" y="-961">s.r = s.s,x = 0</label>
		</transition>
		<transition id="id22">
			<source ref="id1"/>
			<target ref="id9"/>
			<label kind="guard" x="-1316" y="-578">x&gt;=lower</label>
			<label kind="assignment" x="-1385" y="-595">s.r = inter % SSize,
x = 0</label>
			<nail x="-1206" y="-604"/>
		</transition>
		<transition id="id23">
			<source ref="id2"/>
			<target ref="id1"/>
			<label kind="guard" x="-1198" y="-927">x&gt;=lower</label>
			<label kind="assignment" x="-1206" y="-952">x = 0</label>
		</transition>
		<transition id="id24">
			<source ref="id4"/>
			<target ref="id2"/>
			<label kind="guard" x="-1190" y="-1207">x&gt;=lower</label>
			<label kind="assignment" x="-1198" y="-1266">inter = s.s*s.x,
x = 0</label>
		</transition>
		<transition id="id25">
			<source ref="id5"/>
			<target ref="id10"/>
			<label kind="guard" x="-1513" y="-1207">!s.key[s.i] &amp;&amp; x&gt;=lower</label>
			<label kind="assignment" x="-1318" y="-1262">x = 0</label>
			<nail x="-1318" y="-1199"/>
		</transition>
		<transition id="id26">
			<source ref="id3"/>
			<target ref="id7"/>
			<label kind="guard" x="-1895" y="-1249">x&gt;=lower</label>
			<label kind="assignment" x="-1946" y="-1190">iter_done[s.i]  = true, s.i++,x= 0</label>
		</transition>
		<transition id="id27">
			<source ref="id5"/>
			<target ref="id4"/>
			<label kind="guard" x="-1292" y="-1334">s.key[s.i] &amp;&amp; x&gt;=lower</label>
			<label kind="assignment" x="-1292" y="-1283">x = 0</label>
		</transition>
		<transition id="id28">
			<source ref="id7"/>
			<target ref="id5"/>
			<label kind="guard" x="-1589" y="-1308">s.i &lt; SSize &amp;&amp; x&gt;=lower</label>
			<label kind="assignment" x="-1869" y="-1283">x = 0</label>
		</transition>
		<transition id="id29">
			<source ref="id7"/>
			<target ref="id6"/>
			<label kind="guard" x="-1640" y="-1419">s.i == SSize &amp;&amp;x&gt;=lower</label>
			<label kind="assignment" x="-1615" y="-1377">x = 0,s.done = true,d=true</label>
			<nail x="-1895" y="-1385"/>
		</transition>
		<transition id="id30">
			<source ref="id8"/>
			<target ref="id7"/>
			<label kind="guard" x="-2022" y="-1266">x&gt;=lower</label>
			<label kind="assignment" x="-2022" y="-1325">s.s = 1,
s.i = 0,
x = 0</label>
		</transition>
	</template>
	<template>
		<name>Init</name>
		<parameter>GState&amp; one</parameter>
		<declaration>void func () {
    int i= 0;
    for (i = 0; i &lt; SSize; i++) {
            if (0.5 &lt;= random (1.0)) {
                one.key[i] = true;
            }
        }
    }</declaration>
		<location id="id31" x="-68" y="0">
		</location>
		<location id="id32" x="-204" y="0">
			<committed/>
		</location>
		<init ref="id32"/>
		<transition id="id33">
			<source ref="id32"/>
			<target ref="id31"/>
			<label kind="assignment" x="-186" y="0">func ()</label>
		</transition>
	</template>
	<system>// Place template instantiations here



GState stat_one;

//rsa1 = RSA_delay (stat_one);
//rsa2 = RSA_delay (stat_two);
initi = Init (stat_one);

rsa=RSA_delay (stat_one);
system rsa,initi;

// List one or more processes to be composed into a system.
//system rsa1,rsa2, initi;
    //rsa=RSA(stat_one);
//system rsa</system>
	<queries>
		<query>
			<formula/>
			<comment/>
		</query>
		<query>
			<formula>simulate 1 [&lt;=100] {rsa.iter_done}</formula>
			<comment/>
			<result outcome="success" type="quality" timestamp="2022-01-07 17:08:36 +0100">
				<plot title="Simulations (1)" xaxis="time" yaxis="value">
					<series title="rsa.iter_done[0]" type="l" color="0xff0000" encoding="csv">0.0,0.0
18.0,0.0
18.0,1.0
100.000002,1.0
					</series>
					<series title="rsa.iter_done[1]" type="l" color="0xffbf00" encoding="csv">0.0,0.0
34.0,0.0
34.0,1.0
100.000002,1.0
					</series>
					<series title="rsa.iter_done[2]" type="l" color="0x80ff00" encoding="csv">0.0,0.0
50.0,0.0
50.0,1.0
100.000002,1.0
					</series>
					<series title="rsa.iter_done[3]" type="l" color="0x00ff40" encoding="csv">0.0,0.0
66.0,0.0
66.0,1.0
100.000002,1.0
					</series>
					<series title="rsa.iter_done[4]" type="l" color="0x00ffff" encoding="csv">0.0,0.0
82.0,0.0
82.0,1.0
100.000002,1.0
					</series>
					<series title="rsa.iter_done[5]" type="l" color="0x0040ff" encoding="csv">0.0,0.0
98.0,0.0
98.0,1.0
100.000002,1.0
					</series>
					<series title="rsa.iter_done[6]" type="l" color="0x8000ff" encoding="csv">0.0,0.0
100.000002,0.0
					</series>
					<series title="rsa.iter_done[7]" type="l" color="0xff00bf" encoding="csv">0.0,0.0
100.000002,0.0
					</series>
					<comment/>
				</plot>
			</result>
		</query>
		<query>
			<formula/>
			<comment/>
		</query>
		<query>
			<formula>Pr {2} ((&lt;&gt;[0,200] rsa.d))</formula>
			<comment/>
			<result outcome="success" type="interval" value="[0.950056,1] (95% CI)" timestamp="2022-01-06 23:31:15 +0100">
				<details>[0.950056,1] (95% CI)</details>
				<plot title="Probability Density Distribution" xaxis="Run length in time" yaxis="probability density">
					<series title="density" type="b(1.728889)" color="0x0000ff" encoding="csv">91.57000000000994,0.01606683804626427
93.29888888889971,0.02410025706939641
95.02777777778948,0.08033419023132135
96.75666666667927,0.120501285346982
98.48555555556904,0.120501285346982
100.2144444444588,0.1606683804626427
101.9433333333486,0.03213367609252854
103.6722222222384,0.008033419023132135
105.4011111111281,0.01606683804626427
					</series>
					<series title="average" type="pl" color="0x00dd00" encoding="csv">99.11263888890271,0.0
99.11263888890271,0.1606683804626427
					</series>
					<comment>Parameters: α=0.05, ε=0.05, bucket width=1.7289, bucket count=9
Runs: 72 in total, 72 (100%) displayed, 0 (0%) remaining
Span of displayed sample: [91.57, 107.13]
Mean estimate of displayed sample: 99.113 ± 0.69546 (95% CI)</comment>
				</plot>
				<plot title="Probability Distribution" xaxis="Run length in time" yaxis="probability">
					<series title="probability" type="b(1.728889)" color="0x0000ff" encoding="csv">91.57000000000994,0.02777777777777778
93.29888888889971,0.04166666666666666
95.02777777778948,0.1388888888888889
96.75666666667927,0.2083333333333333
98.48555555556904,0.2083333333333333
100.2144444444588,0.2777777777777778
101.9433333333486,0.05555555555555555
103.6722222222384,0.01388888888888889
105.4011111111281,0.02777777777777778
					</series>
					<series title="average" type="pl" color="0x00dd00" encoding="csv">99.11263888890271,0.0
99.11263888890271,0.2777777777777778
					</series>
					<comment>Parameters: α=0.05, ε=0.05, bucket width=1.7289, bucket count=9
Runs: 72 in total, 72 (100%) displayed, 0 (0%) remaining
Span of displayed sample: [91.57, 107.13]
Mean estimate of displayed sample: 99.113 ± 0.69546 (95% CI)</comment>
				</plot>
				<plot title="Cumulative Probability Distribution" xaxis="Run length in time" yaxis="probability">
					<series title="cumulative" type="l" color="0x000000" encoding="csv">91.57000000000994,0.0
93.29888888889971,0.02777777777777778
95.02777777778948,0.06944444444444445
96.75666666667927,0.2083333333333333
98.48555555556904,0.4166666666666667
100.2144444444588,0.625
101.9433333333486,0.9027777777777778
103.6722222222384,0.9583333333333334
105.4011111111281,0.9722222222222222
					</series>
					<series title="average" type="pl" color="0x00dd00" encoding="csv">99.11263888890271,0.0
99.11263888890271,1.0
					</series>
					<comment>Parameters: α=0.05, ε=0.05, bucket width=1.7289, bucket count=9
Runs: 72 in total, 72 (100%) displayed, 0 (0%) remaining
Span of displayed sample: [91.57, 107.13]
Mean estimate of displayed sample: 99.113 ± 0.69546 (95% CI)</comment>
				</plot>
				<plot title="Cumulative Probability Confidence Intervals" xaxis="Run length in time" yaxis="probability">
					<series title="upper limit" type="k" color="0x0000dd" encoding="csv">91.57000000000994,0.04994408370585468
93.29888888889971,0.09676728911341523
95.02777777778948,0.1546673148161231
96.75666666667927,0.3202295111293716
98.48555555556904,0.5388867416042286
100.2144444444588,0.7363890523983516
101.9433333333486,0.9600104990663975
103.6722222222384,0.9913235026836562
105.4011111111281,0.9966180996738268
					</series>
					<series title="upper limit" type="k" color="0xdd0000" encoding="csv">91.57000000000994,0.0
93.29888888889971,0.003381900326173238
95.02777777778948,0.02293165915374548
96.75666666667927,0.1215512029078083
98.48555555556904,0.3015211682310392
100.2144444444588,0.5029859293712835
101.9433333333486,0.8098896595544408
103.6722222222384,0.8830251801740586
105.4011111111281,0.9032327108865847
					</series>
					<series title="cumulative" type="l" color="0x000000" encoding="csv">91.57000000000994,0.0
93.29888888889971,0.02777777777777778
95.02777777778948,0.06944444444444445
96.75666666667927,0.2083333333333333
98.48555555556904,0.4166666666666667
100.2144444444588,0.625
101.9433333333486,0.9027777777777778
103.6722222222384,0.9583333333333334
105.4011111111281,0.9722222222222222
					</series>
					<series title="average" type="pl" color="0x00dd00" encoding="csv">99.11263888890271,0.0
99.11263888890271,1.0
					</series>
					<comment>Parameters: α=0.05, ε=0.05, bucket width=1.7289, bucket count=9
Runs: 72 in total, 72 (100%) displayed, 0 (0%) remaining
Span of displayed sample: [91.57, 107.13]
Mean estimate of displayed sample: 99.113 ± 0.69546 (95% CI)</comment>
				</plot>
				<plot title="Frequency Histogram" xaxis="Run length in time" yaxis="count">
					<series title="count" type="b(1.728889)" color="0x0000ff" encoding="csv">91.57000000000994,2.0
93.29888888889971,3.0
95.02777777778948,10.0
96.75666666667927,15.0
98.48555555556904,15.0
100.2144444444588,20.0
101.9433333333486,4.0
103.6722222222384,1.0
105.4011111111281,2.0
					</series>
					<series title="average" type="pl" color="0x00dd00" encoding="csv">99.11263888890271,0.0
99.11263888890271,20.0
					</series>
					<comment>Parameters: α=0.05, ε=0.05, bucket width=1.7289, bucket count=9
Runs: 72 in total, 72 (100%) displayed, 0 (0%) remaining
Span of displayed sample: [91.57, 107.13]
Mean estimate of displayed sample: 99.113 ± 0.69546 (95% CI)</comment>
				</plot>
			</result>
		</query>
		<query>
			<formula/>
			<comment/>
		</query>
		<query>
			<formula>Pr {2} ((((0#!rsa.d) &amp;&amp; (1#!rsa.d)) U[0,150] (((0#rsa.d) &amp;&amp; (&lt;&gt;[0,3] (1#rsa.d))) || ((1#rsa.d) &amp;&amp; (&lt;&gt;[0,3] (0#rsa.d))))))</formula>
			<comment/>
		</query>
	</queries>
</nta>
